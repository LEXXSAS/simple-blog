import{R,r as l,j as e}from"./react-64cc6456.js";import{c as Ee}from"./react-dom-a6bd7853.js";import{L as y,c as be,R as Re}from"./react-router-dom-d8c941e2.js";import{u as b,a as u,P as Ue}from"./react-redux-09f5e4cd.js";import{c as N,a as P,b as ke,f as Oe,d as De}from"./@reduxjs-863128a7.js";import{a as v}from"./axios-4d564c32.js";import{c as ie,a as k}from"./yup-0f34933d.js";import{o as ne}from"./@hookform-c217e4a9.js";import{u as le,F as re}from"./react-hook-form-562096cd.js";import{c as B,d as O,O as Be}from"./react-router-6f2a948d.js";import{u as Fe}from"./react-intersection-observer-9c7ef85c.js";import{I as ce,_ as F}from"./react-hot-toast-21bfcf80.js";import{h as ae}from"./moment-a9aaa855.js";import{R as Qe}from"./react-quill-042080e8.js";/* empty css                    */import{Q as Ge,a as Le}from"./react-query-e2e7fe09.js";import"./lodash-c86a663f.js";import"./scheduler-765c72db.js";import"./@remix-run-e9cd9753.js";import"./use-sync-external-store-75d8866b.js";import"./redux-ea15d17b.js";import"./immer-df973b50.js";import"./reselect-07fd8978.js";import"./redux-thunk-f771c803.js";import"./property-expr-38205fa5.js";import"./tiny-case-d0726479.js";import"./toposort-a73d2261.js";import"./goober-70b4b9ca.js";import"./quill-67d61cc6.js";import"./@babel-a3f164e7.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const A of document.querySelectorAll('link[rel="modulepreload"]'))a(A);new MutationObserver(A=>{for(const n of A)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function o(A){const n={};return A.integrity&&(n.integrity=A.integrity),A.referrerPolicy&&(n.referrerPolicy=A.referrerPolicy),A.crossOrigin==="use-credentials"?n.credentials="include":A.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(A){if(A.ep)return;A.ep=!0;const n=o(A);fetch(A.href,n)}})();const Ve={load:!1,status:"uninitialized",registerdata:null,err:null},W=N("registerdata/userLogin",async(t,{rejectWithValue:s,dispatch:o})=>{try{const a=await v.post("http://localhost:8888/api/auth/register",t);o(de(a.data))}catch(a){console.log(a),o(z(a.response.data))}}),ge=P({name:"registerdata",initialState:Ve,reducers:{setRegister:(t,s)=>{t.registerdata=s.payload,t.load=!1},setRegisterError:(t,s)=>{t.err=s.payload,t.load=!1}},extraReducers:t=>{t.addCase(W.pending,(s,o)=>{s.status="loading",s.load=!0}),t.addCase(W.fulfilled,(s,o)=>{s.status="fulfilled"})}}),{setRegister:de,setRegisterError:z}=ge.actions,Je=ge.reducer,Te=ie().shape({username:k().min(2,"Логин должен содержать минимум 2 символа").required("Укажите логин"),email:k().min(4,"Почта должна содержать минимум 4 символа").email().required("Укажите почту"),password:k().min(8,"Пароль должен содержать минимум 8 символов").max(32).matches(/(?=.*[!@#$%^&*()\-_=+{};:,<.>]{1})/,"Пароль должен содержать хотя бы один спецсимвол").required("Это обязательное поле")}),He=()=>{var K,m,h;const t=b(),s=u(g=>g.register.err),o=u(g=>g.register.registerdata),a=R.useRef(),{handleSubmit:A,register:n,formState:{errors:i}}=le({resolver:ne(Te)}),[C,x]=l.useState({username:"",email:"",password:""}),d=B();l.useEffect(()=>{o==="Пользователь создан успешно"&&(a.current.reset(),t(de(null)),t(z(null)),d("/login"))},[o]);const p=g=>{x(r=>({...r,[g.target.name]:g.target.value}))},w=async()=>{t(z(null)),t(W(C))},j=g=>{g.key==="Enter"&&w()};return console.log("registerdata",o),console.log("err",s),e.jsxs("div",{className:"auth",children:[e.jsx("h1",{children:"Регистрация"}),e.jsx(re,{children:e.jsxs("form",{ref:a,onKeyPress:j,children:[e.jsxs("div",{children:[e.jsx("input",{...n("username"),type:"text",placeholder:"имя пользователя",name:"username",onChange:p}),!i.username&&!s&&e.jsx("p",{}),s&&e.jsx("p",{children:s}),i.username&&e.jsx("p",{children:(K=i.username)==null?void 0:K.message})]}),e.jsxs("div",{children:[e.jsx("input",{...n("email"),type:"email",placeholder:"email",name:"email",onChange:p}),!i.email&&e.jsx("p",{}),i.email&&e.jsx("p",{children:(m=i.email)==null?void 0:m.message})]}),e.jsxs("div",{children:[e.jsx("input",{...n("password"),type:"text",placeholder:"пароль",name:"password",onChange:p}),!i.password&&e.jsx("p",{}),i.password&&e.jsx("p",{children:(h=i.password)==null?void 0:h.message})]}),e.jsx("button",{onClick:A(w),children:"Зарегистрироваться"}),e.jsxs("span",{children:["Уже есть аккаунт? ",e.jsx(y,{to:"/login",children:"Войти"})]})]})})]})},Me={load:!1,status:"uninitialized",currentUser:JSON.parse(localStorage.getItem("user"))||null,err:null,useravatar:null},$=N("currentUser/userLogin",async(t,{rejectWithValue:s,dispatch:o})=>{var a;try{const A=await v.post("http://localhost:8888/api/auth/login",t,{withCredentials:!0});localStorage.setItem("token",(a=A.data)==null?void 0:a.accessToken),o(Ye(A.data))}catch(A){o(Z(A.response.data))}}),Q=N("currentUser/userLogout",async(t,{rejectWithValue:s,dispatch:o})=>{try{await v.post("http://localhost:8888/api/auth/logout",t,{withCredentials:!0}),o(We(null)),localStorage.removeItem("token"),localStorage.removeItem("user")}catch(a){console.log(a)}}),ue=P({name:"currentUser",initialState:Me,reducers:{setUser:(t,s)=>{t.currentUser=s.payload.userdata,t.useravatar=s.payload.img,t.load=!1},setUserNull:(t,s)=>{t.currentUser=s.payload,t.load=!1},setUserError:(t,s)=>{t.err=s.payload,t.load=!1}},extraReducers:t=>{t.addCase($.pending,(s,o)=>{s.status="loading",s.load=!0}),t.addCase($.fulfilled,(s,o)=>{s.status="fulfilled"})}}),{setUser:Ye,setUserNull:We,setUserError:Z}=ue.actions,ze=ue.reducer,$e=ie().shape({username:k().min(2,"Логин должен содержать минимум 2 символа").required("Укажите логин"),password:k().max(32).required("Это обязательное поле")}),Ze=()=>{var K,m;const t=b(),s=u(h=>h.user.err),o=u(h=>h.user.currentUser),a=R.useRef(),{handleSubmit:A,register:n,formState:{errors:i}}=le({resolver:ne($e)}),[C,x]=l.useState({username:"",password:""}),d=B();R.useEffect(()=>{o!==null&&(a.current.reset(),t(Z(null)),d("/"))},[o]);const p=h=>{x(g=>({...g,[h.target.name]:h.target.value}))},w=async()=>{t(Z(null)),t($(C))},j=h=>{h.key==="Enter"&&w()};return e.jsxs("div",{className:"auth",children:[e.jsx("h1",{children:"Login"}),e.jsx(re,{children:e.jsxs("form",{ref:a,onKeyPress:j,children:[e.jsxs("div",{children:[e.jsx("input",{...n("username"),type:"text",placeholder:"имя пользователя",name:"username",onChange:p}),!i.username&&!s&&e.jsx("p",{}),s&&e.jsx("p",{children:s}),i.username&&e.jsx("p",{children:(K=i.username)==null?void 0:K.message})]}),e.jsxs("div",{children:[e.jsx("input",{...n("password"),type:"text",placeholder:"пароль",name:"password",onChange:p}),!i.password&&e.jsx("p",{}),i.password&&e.jsx("p",{children:(m=i.password)==null?void 0:m.message})]}),e.jsx("button",{onClick:A(w),children:"Войти"}),e.jsxs("span",{children:["У вас нет аккаунта? ",e.jsx(y,{to:"/register",children:"Зарегистрироваться"})]})]})})]})},qe={posts:[],postscategory:[],load:!1,status:"uninitialized",newcurrentpage:1,rowperpage:null,error:null};N("posts/getPosts",async({currentpage:t},{rejectWithValue:s,dispatch:o,getState:a})=>{let A=a().singlepost.post.cat;try{if(t!==null&&A!==""&&A!==void 0){console.log("cat in post",A);const n=await v.get(`http://localhost:8888/api/posts?currentpage=${t}&cat=${A}`);o(Xe(n.data))}else return}catch(n){console.log(n)}});N("posts/getPostsNextPage",async({cat:t,currentpage:s,count:o},{rejectWithValue:a,dispatch:A})=>{try{if(t!==""&&(t=t.split("=")[1]),s++,s>=o-1)return;const n=await v.get(`http://localhost:8888/api/posts/nextpage?currentpage=${s}&cat=${t}`);localStorage.setItem("starnewpage",n.data.starnewpage),A(pe(n.data))}catch(n){console.log(n)}});N("posts/getPostsNextPage",async({cat:t,currentpage:s,count:o},{rejectWithValue:a,dispatch:A})=>{try{if(t!==""&&(t=t.split("=")[1]),s--,s<=1)return;const n=await v.get(`http://localhost:8888/api/posts/previouspage?currentpage=${s}&cat=${t}`);localStorage.setItem("starnewpage",n.data.starnewpage),A(pe(n.data))}catch(n){console.log(n)}});const Ce=P({name:"posts",initialState:qe,reducers:{setPosts:(t,s)=>{t.posts=s.payload.data,t.rowperpage=s.payload.rowperpage,t.load=!1},setPostsCategory:(t,s)=>{t.postscategory=s.payload.data,t.rowperpage=s.payload.rowperpage,t.load=!1},setPostsNextPosts:(t,s)=>{t.posts=s.payload.data,t.newcurrentpage=s.payload.starnewpage,t.load=!1},setNewPage:(t,s)=>{t.newcurrentpage=s.payload},setNewPageZero:(t,s)=>{t.newcurrentpage=1},setNewCurrentPage:(t,s)=>{t.newcurrentpage=s.payload}}}),{setPosts:Es,setNewPage:bs,setPostsNextPosts:pe,setNewPageZero:Ke,setPostsCategory:Xe,setNewCurrentPage:oe}=Ce.actions,_e=Ce.reducer,et={status:"uninitialized",count:null,allpages:null},D=N("count/getCount",async(t,{rejectWithValue:s,dispatch:o})=>{try{t!==""&&(t=t.split("=")[1]);const a=await v.get(`http://localhost:8888/api/posts/count?cat=${t}`,{});o(tt(a.data.count)),o(st(a.data.pages))}catch(a){console.log(a)}}),me=P({name:"count",initialState:et,reducers:{setCount:(t,s)=>{t.count=s.payload},setCountAllPages:(t,s)=>{t.allpages=s.payload}},extraReducers:t=>{t.addCase(D.pending,(s,o)=>{s.status="loading"}),t.addCase(D.fulfilled,(s,o)=>{s.status="fulfilled"})}}),{setCount:tt,setCountAllPages:st}=me.actions,ot=me.reducer,at={userinfo:null,load:!1,statusloading:"uninitialized",errormessage:null},E=N("user/getUserInfo",async(t,{rejectWithValue:s,dispatch:o})=>{var a,A,n;try{const i=await v.post("http://localhost:8888/api/auth/userinfo",t,{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("token")}`}});localStorage.setItem("token",(a=i.data)==null?void 0:a.accessToken),o(At((A=i.data)==null?void 0:A.userdata))}catch(i){o(it((n=i==null?void 0:i.response)==null?void 0:n.data))}}),he=P({name:"file",initialState:at,reducers:{setUserInfo:(t,s)=>{t.userinfo=s.payload,t.load=!1},setStatusUserInfoNull:(t,s)=>{t.statusloading="uninitialized"},setStatusUserInfoError:(t,s)=>{t.errormessage=s.payload}},extraReducers:t=>{t.addCase(E.pending,(s,o)=>{s.statusloading="loading",s.loadfile=!0}),t.addCase(E.fulfilled,(s,o)=>{s.statusloading="fulfilled"})}}),{setUserInfo:At,setStatusUserInfoNull:Rs,setStatusUserInfoError:it}=he.actions,nt=he.reducer,lt={file:null,loadfile:!1,statusavatarupload:"uninitialized"},q=N("file/uploadFile",async(t,{rejectWithValue:s,dispatch:o})=>{try{const a=await v.post("http://localhost:8888/api/uploadavatar/avatar",t,{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("token")}`}});o(X(a.data))}catch(a){console.log(a)}}),fe=P({name:"file",initialState:lt,reducers:{setAvatarFile:(t,s)=>{t.file=s.payload,t.loadfile=!1},setStatusFileUpload:(t,s)=>{t.statusavatarupload="uninitialized"}},extraReducers:t=>{t.addCase(q.pending,(s,o)=>{s.statusavatarupload="loading",s.loadfile=!0}),t.addCase(q.fulfilled,(s,o)=>{s.statusavatarupload="fulfilled"})}}),{setAvatarFile:X,setStatusFileUpload:rt}=fe.actions,ct=fe.reducer,J=({src:t,placeholderSrc:s,width:o="100%",...a})=>{const[A,n]=l.useState(s),i=`progressive ${A===s?"loading":"loaded"}`;return l.useEffect(()=>{const C=new Image;C.src=t,C.onload=()=>{n(t)}},[t]),e.jsx("img",{className:i,src:A,alt:a.alt||"",width:o})},gt=({props:t})=>{const{post:s}=t,{ref:o,inView:a}=Fe({threshold:.15,triggerOnce:!0});return e.jsxs("div",{ref:o,id:"post",className:"post",children:[e.jsx("div",{className:"img",children:a?e.jsx(y,{className:"link",to:`/post/${s.id}`,children:e.jsx(J,{src:s==null?void 0:s.md,placeholderSrc:s==null?void 0:s.sm,width:"396.6",height:"400"})}):e.jsx(y,{className:"link",to:`/post/${s.id}`,children:e.jsx(J,{src:s==null?void 0:s.sm,placeholderSrc:s==null?void 0:s.sm,width:"396.6",height:"400"})})}),e.jsxs("div",{className:"content",children:[e.jsx(y,{className:"link",to:`/post/${s.id}`,children:e.jsx("h1",{id:"home-title",children:s.title})}),`${s.desc}`.length>100?e.jsx("div",{style:{flexGrow:"1"},id:"home-desc",dangerouslySetInnerHTML:{__html:`${s.desc}`.substring(0,500)+"..."}}):e.jsx("div",{style:{flexGrow:"1"},id:"home-desc",dangerouslySetInnerHTML:{__html:`${s.desc}`.substring(0,500)}}),e.jsx(y,{className:"link",to:`/post/${s.id}`,children:e.jsx("button",{children:"Read more"})})]})]},s.id)},V=ke({reducerPath:"dataApi",tagTypes:["getPostsApi"],baseQuery:Oe({baseUrl:"http://localhost:8888/api/"}),endpoints:t=>({getData:t.query({queryFn:async({cat:s="",countresult:o="",currentpage:a=""})=>{try{return s!==""&&s!==void 0&&(s=s.split("=")[1]),a!==null?{data:(await v.get(`http://localhost:8888/api/posts?currentpage=${a}&cat=${s}&countresult=${o}`)).data}:{data:(await v.get(`http://localhost:8888/api/posts?currentpage=0&cat=${s}`)).data}}catch(A){return{error:A.message}}},providesTags:s=>s?[...s.data.map(({id:o})=>({type:"getPostsApi",id:o})),{type:"getPostsApi",id:"POST"}]:[{type:"getPostsApi",id:"POST"}]}),getCategegoryData:t.query({queryFn:async({cat:s="",currentpage:o=""})=>{try{return o!==null&&o>=0&&s!==""&&s!==void 0?{data:(await v.get(`http://localhost:8888/api/posts?currentpage=${o}&cat=${s}`)).data}:{data:[]}}catch(a){return{error:a.message}}},invalidatesTags:[{type:"getPostsApi",id:"POST"}]}),updateData:t.mutation({queryFn:async({cat:s="",countresult:o="",currentpage:a=""})=>{try{return s!==""&&s!==void 0&&(s=s.split("=")[1]),a!==null?{data:(await v.get(`http://localhost:8888/api/posts?currentpage=${a}&cat=${s}&countresult=${o}`)).data}:{data:(await v.get(`http://localhost:8888/api/posts?currentpage=0&cat=${s}`)).data}}catch(A){return{error:A.message}}},invalidatesTags:[{type:"getPostsApi",id:"POST"}]})})}),{useGetDataQuery:dt,useGetCategegoryDataQuery:ut,useUpdateDataMutation:Ct}=V,pt=({totalPosts:t,postsPerPages:s,setCurrentPage:o,currentPage:a})=>{const A=R.useMemo(()=>{let n=[];if(t.length!==0)for(let i=1;i<=Math.ceil(t/s);i++)n.push(i);return n},[t]);return e.jsx("div",{className:"pagination",children:A.map((n,i)=>e.jsx("button",{onClick:()=>o(n),className:n==a?"active":"",children:n},i))})},Kt={info:null},xe=P({name:"posts",initialState:Kt,reducers:{setInfoReducer:(t,s)=>{t.info=s.payload},setInfoDefaulReducer:(t,s)=>{t.info=s.payload}}}),{setInfoReducer:U,setInfoDefaulReducer:Y}=xe.actions,mt=xe.reducer,ht={display:"flex",padding:"8px 16px",alignItems:"center",fontFamily:"cursive",backgroundColor:"#ad52ee43",borderRadius:"3px",fontSize:"1rem"},ft={display:"flex",padding:"8px 16px",alignItems:"center",fontFamily:"cursive",backgroundColor:"#52eec243",borderRadius:"3px",fontSize:"1rem"},xt={display:"flex",padding:"8px 16px",alignItems:"center",fontFamily:"cursive",backgroundColor:"#ee835243",borderRadius:"3px",fontSize:"1rem"},jt=t=>F.custom(e.jsxs("div",{style:ht,children:[e.jsx("div",{children:"✅"}),e.jsx("div",{children:t})]}),{duration:2500,position:"top-center"}),yt=t=>F.custom(e.jsxs("div",{style:ft,children:[e.jsx("div",{children:"✅"}),e.jsx("div",{children:t})]}),{duration:2500,position:"top-center"}),vt=t=>F.custom(e.jsxs("div",{style:xt,children:[e.jsx("div",{children:"✅"}),e.jsx("div",{children:t})]}),{duration:2500,position:"top-center",icon:"✅",style:{background:"#52eebf43"}}),St=()=>{const t=b(),s=u(S=>S.countpages.count),o=u(S=>S.user.currentUser),a=u(S=>S.info.info),A=u(S=>S.userinfo.userinfo),n=u(S=>S.userinfo.errormessage),[i,C]=l.useState([]),[x,d]=l.useState(1),[p,w]=l.useState(!1),j=O().search,K=O().pathname,{data:m=[],error:h,isLoading:g,isError:r,isSuccess:f,isFetching:I,isUninitialized:M}=dt({cat:j,countresult:s||"",currentpage:x-1},{skip:!p}),G=u(S=>S.write.statusupdatepost),c=u(S=>S.deletesinglepost.status),[Pe]=Ct();return l.useEffect(()=>{JSON.parse(localStorage.getItem("user"))!==null&&localStorage.getItem("token")!==null&&t(E())},[]),l.useEffect(()=>{if(n!==null&&n==="Not authenticated!"||localStorage.getItem("token")===null)t(Q());else if(A!==null){const S=JSON.stringify(A);JSON.stringify(localStorage.setItem("user",S))}},[A,n]),l.useEffect(()=>{console.log("%cinfo =>","color: #52eec29a",a)},[a]),l.useEffect(()=>(a!==null&&a==="created"&&setTimeout(()=>{vt("Пост успешно создан")},[250]),()=>{t(Y(null))}),[a]),l.useEffect(()=>(a!==null&&a==="updated"&&setTimeout(()=>{yt("Пост успешно обновлен")},[250]),()=>{t(Y(null))}),[a]),l.useEffect(()=>(a!==null&&a==="deleted"&&setTimeout(()=>{jt("Пост успешно удален")},[250]),()=>{t(Y(null))}),[a]),l.useEffect(()=>{(G=="fulfilled"||c=="fulfilled")&&(Pe({cat:j,countresult:s||"",currentpage:x-1}),t(D(j)))},[G,c]),l.useEffect(()=>{s!==null&&setTimeout(()=>{w(!0)},250)},[s]),l.useEffect(()=>{localStorage.setItem("user",JSON.stringify(o))},[o]),l.useEffect(()=>{K.split("/")[1]===""&&(localStorage.setItem("starnewpage",0),localStorage.setItem("category",j.split("=")[1]),t(D(j)),t(Ke()),d(1),t(oe(1)))},[j]),l.useEffect(()=>{m.length!==0&&C(m.rowperpage)},[m]),l.useEffect(()=>{localStorage.setItem("category","undefined"),localStorage.setItem("menu_currentpage",0),t(rt())},[]),r?(console.log("error",h),e.jsxs("div",{style:{minHeight:"calc(100vh - 70px)",marginTop:"1rem"},children:[e.jsx("br",{}),e.jsx("h1",{id:"home-title"}),e.jsxs("div",{style:{flexGrow:"1"},id:"home-desc",children:[e.jsx("h1",{className:"information-text",children:h}),e.jsx("br",{}),e.jsx("hr",{})]})]})):g||M?e.jsx("div",{className:"home",children:e.jsx("div",{className:"posts",children:e.jsx("div",{id:"post",className:"post",children:e.jsxs("div",{className:"content",children:[e.jsx("h1",{id:"home-title"}),e.jsx("div",{id:"home-desc",children:e.jsx("div",{style:{display:"flex",gap:"10px",justifyContent:"center",flexGrow:"1"},children:e.jsxs("div",{className:"lds-ellipsis",children:[e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{})]})})})]})},"")})}):f&&m.data.length<1?e.jsx("div",{className:"home",children:e.jsx("div",{className:"posts",children:e.jsx("div",{id:"post",className:"post",children:e.jsxs("div",{className:"content",children:[e.jsx("h1",{id:"home-title"}),e.jsx("div",{style:{flexGrow:"1"},id:"home-desc",children:e.jsx("h1",{children:"Пока тут ничего нет..."})})]})},"")})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"home",children:[e.jsx(ce,{}),e.jsxs("div",{className:"posts",children:[m.data&&m.data.map(S=>e.jsx(gt,{props:{post:S}},S.id)),i.length!==0&&e.jsx(pt,{postsPerPages:i,setCurrentPage:d,currentPage:x,totalPosts:s})]})]})})},je="/assets/logo-aa694617.png",wt=()=>{const t=b(),s=u(A=>A.user.currentUser),[o,a]=l.useState(null);return l.useEffect(()=>{a(s!==null?s:null)},[s]),e.jsx("div",{className:"navbar",children:e.jsxs("div",{className:"container",children:[e.jsx("div",{id:"logo",className:"logo",children:e.jsx(y,{to:"/",onClick:()=>location.pathname("/"),children:e.jsx("img",{src:je,alt:""})})}),e.jsxs("div",{id:"links",className:"links",children:[e.jsx(y,{className:"link",to:"/?cat=art",children:e.jsx("h6",{children:"ART"})}),e.jsx(y,{className:"link",to:"/?cat=science",children:e.jsx("h6",{children:"SCIENCE"})}),e.jsx(y,{className:"link",to:"/?cat=technology",children:e.jsx("h6",{children:"TECHNOLOGY"})}),e.jsx(y,{className:"link",to:"/?cat=cinema",children:e.jsx("h6",{children:"CINEMA"})}),e.jsx(y,{className:"link",to:"/?cat=design",children:e.jsx("h6",{children:"DESIGN"})}),e.jsx(y,{className:"link",to:"/?cat=food",children:e.jsx("h6",{children:"FOOD"})}),e.jsx(y,{to:"/profile",children:e.jsx("span",{children:o==null?void 0:o.username})}),o?e.jsx("span",{onClick:()=>t(Q()),children:"Logout"}):e.jsx(y,{className:"link",to:"/login",children:"Login"}),s!==null?e.jsx("span",{className:"write",children:e.jsx(y,{className:"link",to:"/write",children:"Write"})}):null]})]})})},Nt=()=>e.jsxs("footer",{children:[e.jsx("img",{src:je,alt:""}),e.jsxs("span",{children:["Made in 2024 year ",e.jsx("b",{children:"React.js"}),"."]})]}),It={writepostdata:null,updatepostdata:null,file:null,load:!1,loadfile:!1,writepostload:!1,updatepostload:!1,status:"uninitialized",statusfileupload:"uninitialized",statusupdatepost:"uninitialized",statuswritepost:"uninitialized",infoaboutaddorupdateapost:""},_=N("file/uploadFile",async(t,{rejectWithValue:s,dispatch:o})=>{try{const a=await v.post("http://localhost:8888/api/upload",t,{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("token")}`}});o(Pt(a.data))}catch(a){console.log(a)}}),T=N("posts/updatePost",async(t,{rejectWithValue:s,dispatch:o})=>{const{state:a,title:A,desc:n,cat:i,img:C}=t;await v.put(`http://localhost:8888/api/posts/${a.id}`,{title:A,desc:n,cat:i,img:C},{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("token")}`}})}),H=N("posts/writePost",async(t,{rejectWithValue:s,dispatch:o})=>{const{title:a,desc:A,cat:n,img:i,date:C}=t;await v.post("http://localhost:8888/api/posts/",{title:a,desc:A,cat:n,img:i,date:C},{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("token")}`}})}),ye=P({name:"file",initialState:It,reducers:{setFile:(t,s)=>{t.file=s.payload,t.loadfile=!1},setFileNull:(t,s)=>{t.file=null,t.loadfile=!1},setStatusFileUploadNull:(t,s)=>{t.statusfileupload="uninitialized",t.loadfile=!1},setWritePostData:(t,s)=>{t.writepostdata=s.payload,t.loadfile=!1},setInformation:(t,s)=>{t.infoaboutaddorupdateapost=s.payload},setInformationNull:(t,s)=>{t.infoaboutaddorupdateapost=""},setInformationWritePostNull:(t,s)=>{t.statuswritepost="uninitialized"},setInformationUpdatePostNull:(t,s)=>{t.statuswritepost="uninitialized"}},extraReducers:t=>{t.addCase(T.pending,(s,o)=>{s.statusupdatepost="loading",s.updatepostload=!0}),t.addCase(T.fulfilled,(s,o)=>{s.statusupdatepost="fulfilled"}),t.addCase(H.pending,(s,o)=>{s.statuswritepost="loading",s.updatepostload=!0}),t.addCase(H.fulfilled,(s,o)=>{s.statuswritepost="fulfilled"}),t.addCase(_.pending,(s,o)=>{s.statusfileupload="loading",s.loadfile=!0}),t.addCase(_.fulfilled,(s,o)=>{s.statusfileupload="fulfilled"})}}),{setFile:Pt,setFileNull:Et,setWritePostData:Us,setStatusFileUploadNull:bt,setInformation:L,setInformationNull:ee,setInformationWritePostNull:ks,setInformationUpdatePostNull:Os}=ye.actions,Rt=ye.reducer,ve=({info:t})=>e.jsxs("div",{style:{minHeight:"calc(100vh - 70px)",marginTop:"1rem"},children:[e.jsx("br",{}),e.jsx("h1",{id:"home-title"}),e.jsxs("div",{style:{flexGrow:"1"},id:"home-desc",children:[e.jsx("h1",{className:"information-text",children:t}),e.jsx("br",{}),e.jsx("hr",{}),e.jsx("p",{className:"information-warning",children:"через несколько секунд вы будете перенаправлены на главную страницу"})]})]}),Ut=()=>{const t=b(),s=u(c=>c.userinfo.userinfo),o=u(c=>c.userinfo.errormessage),a=u(c=>c.write.file),A=u(c=>c.write.statusfileupload),n=u(c=>c.write.infoaboutaddorupdateapost),i=O().state;O().pathname;const[C,x]=l.useState((i==null?void 0:i.desc)||""),[d,p]=l.useState((i==null?void 0:i.title)||""),[w,j]=l.useState(null),[K,m]=l.useState((i==null?void 0:i.cat)||"art"),[h,g]=l.useState((i==null?void 0:i.xl)||""),[r,f]=l.useState(""),I=B();l.useEffect(()=>{JSON.parse(localStorage.getItem("user"))!==null&&localStorage.getItem("token")!==null&&t(E())},[]),l.useEffect(()=>{if(o!==null&&o==="Not authenticated!"||localStorage.getItem("token")===null)t(Q()),I("/");else if(s!==null){const c=JSON.stringify(s);JSON.stringify(localStorage.setItem("user",c))}},[s,o]);const M=async()=>{if(w!==null){const c=new FormData;c.append("file",w),t(_(c))}else i==null&&a==null&&d!==""&&C!==""?(t(H({title:d,desc:C,cat:K,img:h,date:ae(Date.now()).format("YYYY-MM-DD HH:mm:ss")})),t(L("пост создан без добавления изображения")),t(U("created"))):i!==null&&a==null&&d!==""&&C!==""&&(t(T({state:i,title:d,desc:C,cat:K,img:h})),t(L("пост обновлен без добавления изображения")),t(U("updated")))};l.useEffect(()=>(A==="fulfilled"&&a!==null&&(i!==null&&d!==""&&C!==""?(t(T({state:i,title:d,desc:C,cat:K,img:a})),t(L("пост обновлен с добавлением изображения")),t(U("updated"))):d!==""&&C!==""&&(t(H({title:d,desc:C,cat:K,img:a,date:ae(Date.now()).format("YYYY-MM-DD HH:mm:ss")})),t(L("пост создан с добавлением изображения")),t(U("created")))),()=>{t(Et()),t(bt())}),[A]);const G=async c=>{c.preventDefault(),await M()};return l.useEffect(()=>{t(ee()),f("")},[]),l.useEffect(()=>(n!==""&&(n==="пост создан с добавлением изображения"||n==="пост обновлен с добавлением изображения"||n==="пост обновлен без добавления изображения"||n==="пост создан без добавления изображения")&&(f(n),setTimeout(()=>{I("/")},0)),()=>{t(ee()),f("")}),[n]),r!==""?e.jsx(ve,{info:r}):e.jsxs("div",{className:"add",children:[e.jsxs("div",{className:"content",children:[e.jsx("input",{type:"text",placeholder:"Title",value:d,onChange:c=>p(c.target.value)}),e.jsx("div",{className:"editorContainer",children:e.jsx(Qe,{className:"editor",theme:"snow",value:C,onChange:x})})]}),e.jsxs("div",{className:"menu",children:[e.jsxs("div",{className:"item",children:[e.jsx("h1",{children:"Publish"}),e.jsxs("span",{children:[e.jsx("b",{children:"Status: "})," Draft"]}),e.jsxs("span",{children:[e.jsx("b",{children:"Visibility: "})," Public"]}),e.jsx("input",{style:{display:"none"},type:"file",name:"",id:"file",onChange:c=>j(c.target.files[0])}),e.jsx("label",{className:"file",htmlFor:"file",children:"Upload Image"}),e.jsx("div",{className:"buttons",children:e.jsx("button",{onClick:G,children:"Publish"})})]}),e.jsxs("div",{className:"item",children:[e.jsx("h1",{children:"Category"}),e.jsxs("div",{className:"cat",children:[e.jsx("input",{type:"radio",checked:K==="art",name:"cat",value:"art",id:"art",onChange:c=>m(c.target.value)}),e.jsx("label",{htmlFor:"art",children:"Art"})]}),e.jsxs("div",{className:"cat",children:[e.jsx("input",{type:"radio",checked:K==="science",name:"cat",value:"science",id:"science",onChange:c=>m(c.target.value)}),e.jsx("label",{htmlFor:"science",children:"Science"})]}),e.jsxs("div",{className:"cat",children:[e.jsx("input",{type:"radio",checked:K==="technology",name:"cat",value:"technology",id:"technology",onChange:c=>m(c.target.value)}),e.jsx("label",{htmlFor:"technology",children:"Technology"})]}),e.jsxs("div",{className:"cat",children:[e.jsx("input",{type:"radio",checked:K==="cinema",name:"cat",value:"cinema",id:"cinema",onChange:c=>m(c.target.value)}),e.jsx("label",{htmlFor:"cinema",children:"Cinema"})]}),e.jsxs("div",{className:"cat",children:[e.jsx("input",{type:"radio",checked:K==="design",name:"cat",value:"design",id:"design",onChange:c=>m(c.target.value)}),e.jsx("label",{htmlFor:"design",children:"Design"})]}),e.jsxs("div",{className:"cat",children:[e.jsx("input",{type:"radio",checked:K==="food",name:"cat",value:"food",id:"food",onChange:c=>m(c.target.value)}),e.jsx("label",{htmlFor:"food",children:"Food"})]})]})]})]})},kt="/assets/edit-04ba7a77.png",Ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADmGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDIyLTA5LTIzPC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkV4dElkPmM4Nzk5NmE5LWU4NGQtNGM3Zi1iZTRjLWM5YzBmZDc5NzAxYzwvQXR0cmliOkV4dElkPgogICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICA8L3JkZjpsaT4KICAgPC9yZGY6U2VxPgogIDwvQXR0cmliOkFkcz4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6cGRmPSdodHRwOi8vbnMuYWRvYmUuY29tL3BkZi8xLjMvJz4KICA8cGRmOkF1dGhvcj5MYW1hIERldjwvcGRmOkF1dGhvcj4KIDwvcmRmOkRlc2NyaXB0aW9uPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6eG1wPSdodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvJz4KICA8eG1wOkNyZWF0b3JUb29sPkNhbnZh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",Dt="data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEASABIAAD//gAgU1lTVEVNQVggSkZJRiBFbmNvZGVyIFZlci4yLjAA/9sAhAABAQEBAQECAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBgYGBwcHAQMDAwMDAwQEBAQEBAQEBAUFBQUFBQcHBwcHBwcICAgICAgICAoKCgoKCgoLCwsLCwsNDQ0NDQ8PDw8PDw8PDw//wAARCAFKARgDAREAAhEBAxEB/8QBogAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoLEAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+foBAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKCxEAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/90ABACM/9oADAMBAAIRAxEAPwD+nKuo6woAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoA//0P6cq6jrCgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgD//R/pyrqOsKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKAP/9L+nKuo6woAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoA//0/6cq6jrCgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgD//U/pyrqOsKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKAP/9X+nKuo6woAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoA//1v6cq6jrCgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgD//X/pyrqOsKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKAP/9D+nKuo6woAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoA//0f6cq6jrCgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKACgAoAKAP/Z",Ae=({cat:t})=>{const s=b(),[o,a]=l.useState([]),[A,n]=l.useState(Number(localStorage.getItem("menu_currentpage"))),[i,C]=l.useState(null),[x,d]=l.useState(!1),{data:p=[],error:w,isLoading:j,isError:K,isSuccess:m,isFetching:h,isUninitialized:g}=ut({cat:t,currentpage:A-1},{skip:!x,refetchOnMountOrArgChange:!0});l.useEffect(()=>{setTimeout(()=>{d(!0)},0)},[g]),l.useEffect(()=>{t!==void 0&&s(D(`?cat=${t}`))},[t]),l.useEffect(()=>{p.length!==0&&(d(!0),a(p.data),C(p.pages),console.log("%cdata =>","color: #52eec29a",p))},[p]),l.useEffect(()=>{A==0&&n(1)},[A]);const r=async()=>{A+0>=i||(n(f=>f+1),s(oe(A)),localStorage.setItem("menu_currentpage",A+1))};return j||g?e.jsxs("div",{className:"menu",children:[e.jsx("div",{className:"post",style:{alignItems:"center"},children:e.jsx("div",{children:e.jsxs("div",{className:"lds-ellipsis",children:[e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{})]})})}),e.jsx("div",{className:"box-more"})]}):e.jsxs("div",{className:"menu",children:[e.jsx("h1",{children:"Other posts you may like"}),o&&o.map(f=>e.jsxs("div",{className:"post",children:[e.jsx(y,{className:"link",to:`/post/${f.id}`,children:e.jsx(J,{src:f==null?void 0:f.sm,placeholderSrc:Dt,width:"278.86",height:"330"})}),e.jsx("h2",{children:f.title}),e.jsx(y,{className:"link",to:`/post/${f.id}`,children:e.jsx("button",{children:"Read More"})})]},f.id)),e.jsx("div",{className:"box-more",children:e.jsx("button",{className:"btn-more",onClick:r,children:"More"})})]})},Se="/assets/bgImv4-431a50d2.png",Bt={post:{},load:!1,status:"uninitialized"},te=N("post/getSinglePost",async(t,{rejectWithValue:s,dispatch:o})=>{try{const a=await v.get(`http://localhost:8888/api/posts/${t}`);localStorage.setItem("category",a.data.cat),o(Ft(a.data))}catch(a){console.log(a)}}),we=P({name:"post",initialState:Bt,reducers:{setSinglePost:(t,s)=>{t.post=s.payload,t.load=!1}},extraReducers:t=>{t.addCase(te.pending,(s,o)=>{s.status="loading",s.load=!0}),t.addCase(te.fulfilled,(s,o)=>{s.status="fulfilled"})}}),{setSinglePost:Ft}=we.actions,Qt=we.reducer,Gt={deleteload:!1,status:"uninitialized",deleteinformation:""},se=N("deleteload/getSinglePost",async(t,{rejectWithValue:s,dispatch:o})=>{try{const a=await v.delete(`http://localhost:8888/api/posts/${t}`,{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"multipart/form-data",Authorization:`Bearer ${localStorage.getItem("token")}`}});o(Lt(a.data))}catch(a){console.log(a)}}),Ne=P({name:"deleteload",initialState:Gt,reducers:{deletePost:(t,s)=>{t.deleteload=!1,t.deleteinformation=s.payload},deletePostStatusNull:(t,s)=>{t.status="uninitialized"}},extraReducers:t=>{t.addCase(se.pending,(s,o)=>{s.status="loading",s.deleteload=!0}),t.addCase(se.fulfilled,(s,o)=>{s.status="fulfilled"})}}),{deletePost:Lt,deletePostStatusNull:Vt}=Ne.actions,Jt=Ne.reducer,Ie="http://localhost:8888/",Tt=()=>{const t=b(),s=u(g=>g.userinfo.userinfo),o=u(g=>g.userinfo.errormessage),a=u(g=>g.deletesinglepost.status),A=u(g=>g.singlepost.post),n=u(g=>g.singlepost.load),i=u(g=>g.user.currentUser),C=A.userImg?`${Ie+A.userImg}`:Se,x=u(g=>g.write.infoaboutaddorupdateapost),[d,p]=l.useState(""),w=O(),j=B(),K=w.pathname.split("/")[2];l.useEffect(()=>{JSON.parse(localStorage.getItem("user"))!==null&&localStorage.getItem("token")!==null&&t(E())},[]),l.useEffect(()=>{if(o!==null&&o==="Not authenticated!"||localStorage.getItem("token")===null)t(Q());else if(s!==null){const g=JSON.stringify(s);JSON.stringify(localStorage.setItem("user",g))}},[s,o]),l.useEffect(()=>{t(te(K))},[K]),l.useEffect(()=>(a==="fulfilled"&&(t(U("deleted")),j("/")),()=>{t(Vt())}),[a]);const m=()=>{t(se(K))},h=async()=>{m()};return l.useEffect(()=>{localStorage.setItem("starnewpage",0),t(Ke()),t(oe(1))},[]),l.useEffect(()=>(x!==""&&x==="пост был удален"&&(console.log("information",x),p(x)),()=>{t(ee()),p("")}),[x]),d!==""?e.jsx(ve,{info:d}):n?e.jsxs("div",{className:"single",children:[e.jsxs("div",{className:"content",children:[e.jsx("div",{className:"user",children:e.jsx("div",{className:"info",children:e.jsx("span",{})})}),e.jsx("h1",{}),e.jsx("div",{id:"single-desc",style:{minHeight:"100vh",flexGrow:"1"},children:e.jsx("div",{style:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:e.jsxs("div",{className:"lds-ellipsis",children:[e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{})]})})})]}),e.jsx(Ae,{})]}):A.length<1?e.jsx("div",{className:"single",children:e.jsx("div",{className:"posts",children:e.jsx("div",{id:"post",className:"post",children:e.jsxs("div",{className:"content",children:[e.jsx("h1",{id:"home-title"}),e.jsx("div",{id:"home-desc",style:{flexGrow:"1"},children:e.jsx("h1",{children:"Пока тут ничего нет..."})})]})},"")})}):e.jsxs("div",{className:"single",children:[e.jsxs("div",{className:"content",children:[e.jsx("div",{children:e.jsx(J,{src:A==null?void 0:A.xl,placeholderSrc:A==null?void 0:A.sm,width:"695.71"})}),e.jsxs("div",{className:"user",children:[e.jsx("img",{id:"avatar-img",src:C,alt:"avatar"}),e.jsxs("div",{className:"info",children:[e.jsx("span",{children:A==null?void 0:A.username}),e.jsx("p",{children:"Posted 20 hours ago"})]}),i!==null?i.username===(A==null?void 0:A.username)&&e.jsxs("div",{className:"edit",children:[e.jsx(y,{to:`/write?edit=${A.id}`,state:A,children:e.jsx("img",{src:kt,alt:""})}),e.jsx("img",{onClick:h,src:Ot,alt:""})]}):null]}),e.jsx("h1",{children:A.title}),e.jsx("div",{style:{flexGrow:"1"},id:"home-desc",dangerouslySetInnerHTML:{__html:A.desc}})]}),e.jsx(Ae,{cat:A.cat})]})};const Ht={display:"flex",padding:"8px 16px",alignItems:"center",fontFamily:"cursive",backgroundColor:"#fff",border:"1px solid #b9e7e7",color:"black",borderRadius:"3px",fontSize:"1rem"},Mt=()=>F.custom(e.jsxs("div",{style:Ht,children:[e.jsx("div",{children:"✅"}),e.jsx("div",{children:"Аватар загружен!"})]}),{duration:2e3,position:"top-center"}),Yt=()=>F.error("Добавьте файл",{duration:2e3,position:"top-center"}),Wt=()=>{const t=b(),s=u(r=>r.avatar.statusavatarupload),o=u(r=>r.user.currentUser),a=u(r=>r.userinfo.userinfo),A=u(r=>r.userinfo.errormessage),[n,i]=l.useState(JSON.parse(localStorage.getItem("user"))||null),[C,x]=l.useState(Se),d=u(r=>r.avatar.file),[p,w]=R.useState(null),[j,K]=R.useState(null);l.useEffect(()=>{JSON.parse(localStorage.getItem("user"))!==null&&localStorage.getItem("token")!==null&&t(E())},[]),l.useEffect(()=>{A!==null&&A==="Not authenticated!"&&t(Q())},[a,A]);const m=B();l.useEffect(()=>{var r,f,I;return((r=JSON.parse(localStorage.getItem("user")))==null?void 0:r.img)!==void 0&&((f=JSON.parse(localStorage.getItem("user")))==null?void 0:f.img)!==null&&((I=JSON.parse(localStorage.getItem("user")))==null?void 0:I.img)!==""&&x(`${Ie}`+JSON.parse(localStorage.getItem("user")).img),()=>{t(E())}},[]),l.useEffect(()=>{o==null&&m("/")},[o]),l.useEffect(()=>{var r,f;if(d!==null&&(i((r=d==null?void 0:d.file)==null?void 0:r.avatarName),o!==null)){let I={...o};I.img=(f=d==null?void 0:d.file)==null?void 0:f.avatarName,I.img!==void 0&&localStorage.setItem("user",JSON.stringify(I))}},[d]),l.useEffect(()=>{if(p!==null){const r=new FileReader;r.readAsDataURL(p),r.onloadend=()=>{K(r.result)}}},[p]),l.useEffect(()=>(s==="fulfilled"&&(Mt(),t(X({statusavatarupload:"uninitialized",file:d})),t(E())),()=>{t(X({statusavatarupload:"uninitialized"}))}),[s]);const h=async()=>{if(p!==null){const r=new FormData;r.append("file",p),t(q(r)),w(null)}else Yt()},g=async r=>{r.preventDefault(),await h()};return e.jsxs("div",{className:"profile",children:[e.jsx("h1",{children:"Profile"}),j==null?e.jsxs("label",{children:[e.jsx("img",{style:{borderRadius:"50%",width:"120px",height:"120px",objectFit:"cover"},id:"avatar-img",src:C,alt:"avatar"}),e.jsx("input",{style:{display:"none"},hidden:!0,type:"file",name:"",id:"file",onChange:r=>w(r.target.files[0])})]}):e.jsx("img",{style:{borderRadius:"50%",width:"120px",height:"120px",objectFit:"cover"},id:"avatar-img",src:j,alt:"avatar"}),e.jsx("input",{style:{display:"none"},type:"file",name:"",id:"file",onChange:r=>w(r.target.files[0])}),e.jsx("label",{className:"btn-more",htmlFor:"file",children:"Upload avatar"}),e.jsx("div",{className:"buttons",children:e.jsx("button",{className:"btn-more",onClick:g,children:"Apply"})}),e.jsx(ce,{})]})},zt=()=>e.jsxs(e.Fragment,{children:[e.jsx(wt,{}),e.jsx(Be,{}),e.jsx(Nt,{})]}),$t=be([{path:"/",element:e.jsx(zt,{}),children:[{path:"/",element:e.jsx(St,{})},{path:"/post/:id",element:e.jsx(Tt,{})},{path:"/write",element:e.jsx(Ut,{})},{path:"/profile",element:e.jsx(Wt,{})}]},{path:"/register",element:e.jsx(He,{})},{path:"/login",element:e.jsx(Ze,{})}]);function Zt(){return e.jsx("div",{className:"app",children:e.jsx("div",{className:"container",children:e.jsx(Re,{router:$t})})})}const qt=De({reducer:{userinfo:nt,info:mt,post:_e,user:ze,singlepost:Qt,deletesinglepost:Jt,register:Je,write:Rt,countpages:ot,avatar:ct,[V.reducerPath]:V.reducer},middleware:t=>t().concat(V.middleware)}),Xt=new Ge({defaultOptions:{queries:{retry:!1,refetchOnWindowFocus:!1}}});Ee.createRoot(document.getElementById("root")).render(e.jsx(Le,{client:Xt,children:e.jsx(Ue,{store:qt,children:e.jsx(Zt,{})})}));
